Using a slow image processor as `use_fast` is unset and a slow processor was saved with this model. `use_fast=True` will be the default behavior in v4.52, even if the model was saved with a slow processor. This will result in minor differences in outputs. You'll still be able to use a slow processor with `use_fast=False`.
`torch_dtype` is deprecated! Use `dtype` instead!
Loading processor...
Loading base LLaVA model...
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]Loading checkpoint shards:  25%|██▌       | 1/4 [00:01<00:03,  1.01s/it]Loading checkpoint shards:  50%|█████     | 2/4 [00:01<00:01,  1.13it/s]Loading checkpoint shards:  75%|███████▌  | 3/4 [00:02<00:00,  1.17it/s]Loading checkpoint shards: 100%|██████████| 4/4 [00:02<00:00,  1.49it/s]
Initializing Sali-Cache optimization wrapper...
WARNING: Using U2NETP_Placeholder. Download the real model!
TODO: Would load U2Net weights from models/saliency/u2netp.pth
Model loaded successfully (Sali-Cache optimization attached).
Sali-Cache Frame 0: cache=1192 time=0.799s [pruned=0, quant=0, kept=196] (before_opt=1192, after_opt=1192)
Sali-Cache Frame 1: cache=1500 time=0.176s [pruned=193, quant=0, kept=3] (before_opt=2384, after_opt=2191)
Sali-Cache Frame 2: cache=1500 time=0.201s [pruned=138, quant=0, kept=58] (before_opt=2692, after_opt=2554)
Sali-Cache Frame 3: cache=1500 time=0.233s [pruned=82, quant=0, kept=114] (before_opt=2692, after_opt=2610)
Sali-Cache Frame 4: cache=1500 time=0.228s [pruned=90, quant=0, kept=106] (before_opt=2692, after_opt=2602)
Sali-Cache Frame 5: cache=1500 time=0.170s [pruned=193, quant=0, kept=3] (before_opt=2692, after_opt=2499)
Sali-Cache Frame 6: cache=1500 time=0.172s [pruned=190, quant=0, kept=6] (before_opt=2692, after_opt=2502)
Sali-Cache Frame 7: cache=1500 time=0.237s [pruned=75, quant=0, kept=121] (before_opt=2692, after_opt=2617)
Sali-Cache Frame 8: cache=1500 time=0.236s [pruned=77, quant=0, kept=119] (before_opt=2692, after_opt=2615)
Sali-Cache Frame 9: cache=1500 time=0.235s [pruned=80, quant=0, kept=116] (before_opt=2692, after_opt=2612)
Sali-Cache Frame 10: cache=1500 time=0.234s [pruned=79, quant=0, kept=117] (before_opt=2692, after_opt=2613)
Sali-Cache Frame 11: cache=1500 time=0.212s [pruned=118, quant=0, kept=78] (before_opt=2692, after_opt=2574)
Sali-Cache Frame 12: cache=1500 time=0.168s [pruned=194, quant=0, kept=2] (before_opt=2692, after_opt=2498)
Sali-Cache Frame 13: cache=1500 time=0.203s [pruned=136, quant=0, kept=60] (before_opt=2692, after_opt=2556)
Sali-Cache Frame 14: cache=1500 time=0.173s [pruned=188, quant=0, kept=8] (before_opt=2692, after_opt=2504)
Sali-Cache Frame 15: cache=1500 time=0.168s [pruned=195, quant=0, kept=1] (before_opt=2692, after_opt=2497)
Sali-Cache Frame 16: cache=1500 time=0.178s [pruned=179, quant=0, kept=17] (before_opt=2692, after_opt=2513)
Sali-Cache Frame 17: cache=1500 time=0.190s [pruned=158, quant=0, kept=38] (before_opt=2692, after_opt=2534)
Sali-Cache Frame 18: cache=1500 time=0.178s [pruned=178, quant=0, kept=18] (before_opt=2692, after_opt=2514)
Sali-Cache Frame 19: cache=1500 time=0.204s [pruned=133, quant=0, kept=63] (before_opt=2692, after_opt=2559)
Sali-Cache Frame 20: cache=1500 time=0.213s [pruned=121, quant=0, kept=75] (before_opt=2692, after_opt=2571)
Sali-Cache Frame 21: cache=1500 time=0.195s [pruned=149, quant=0, kept=47] (before_opt=2692, after_opt=2543)
Sali-Cache Frame 22: cache=1500 time=0.215s [pruned=112, quant=0, kept=84] (before_opt=2692, after_opt=2580)
Sali-Cache Frame 23: cache=1500 time=0.190s [pruned=159, quant=0, kept=37] (before_opt=2692, after_opt=2533)
Sali-Cache Frame 24: cache=1500 time=0.165s [pruned=196, quant=0, kept=0] (before_opt=2692, after_opt=2496)
Sali-Cache Frame 25: cache=1500 time=0.185s [pruned=167, quant=0, kept=29] (before_opt=2692, after_opt=2525)
Sali-Cache Frame 26: cache=1500 time=0.196s [pruned=147, quant=0, kept=49] (before_opt=2692, after_opt=2545)
Sali-Cache Frame 27: cache=1500 time=0.211s [pruned=121, quant=0, kept=75] (before_opt=2692, after_opt=2571)
Sali-Cache Frame 28: cache=1500 time=0.229s [pruned=90, quant=0, kept=106] (before_opt=2692, after_opt=2602)
Sali-Cache Frame 29: cache=1500 time=0.235s [pruned=80, quant=0, kept=116] (before_opt=2692, after_opt=2612)
Sali-Cache Frame 30: cache=1500 time=0.220s [pruned=104, quant=0, kept=92] (before_opt=2692, after_opt=2588)
Sali-Cache Frame 31: cache=1500 time=0.220s [pruned=104, quant=0, kept=92] (before_opt=2692, after_opt=2588)
Sali-Cache Frame 32: cache=1500 time=0.224s [pruned=99, quant=0, kept=97] (before_opt=2692, after_opt=2593)
Sali-Cache Frame 33: cache=1500 time=0.214s [pruned=115, quant=0, kept=81] (before_opt=2692, after_opt=2577)
Sali-Cache Frame 34: cache=1500 time=0.240s [pruned=71, quant=0, kept=125] (before_opt=2692, after_opt=2621)
Sali-Cache Frame 35: cache=1500 time=0.215s [pruned=113, quant=0, kept=83] (before_opt=2692, after_opt=2579)
Sali-Cache Frame 36: cache=1500 time=0.238s [pruned=74, quant=0, kept=122] (before_opt=2692, after_opt=2618)
Sali-Cache Frame 37: cache=1500 time=0.246s [pruned=59, quant=0, kept=137] (before_opt=2692, after_opt=2633)
Sali-Cache Frame 38: cache=1500 time=0.220s [pruned=105, quant=0, kept=91] (before_opt=2692, after_opt=2587)
Sali-Cache Frame 39: cache=1500 time=0.195s [pruned=149, quant=0, kept=47] (before_opt=2692, after_opt=2543)
Sali-Cache Frame 40: cache=1500 time=0.169s [pruned=194, quant=0, kept=2] (before_opt=2692, after_opt=2498)
Sali-Cache Frame 41: cache=1500 time=0.169s [pruned=194, quant=0, kept=2] (before_opt=2692, after_opt=2498)
Sali-Cache Frame 42: cache=1500 time=0.217s [pruned=110, quant=0, kept=86] (before_opt=2692, after_opt=2582)
Sali-Cache Frame 43: cache=1500 time=0.231s [pruned=87, quant=0, kept=109] (before_opt=2692, after_opt=2605)
Sali-Cache Frame 44: cache=1500 time=0.240s [pruned=70, quant=0, kept=126] (before_opt=2692, after_opt=2622)
Sali-Cache Frame 45: cache=1500 time=0.225s [pruned=97, quant=0, kept=99] (before_opt=2692, after_opt=2595)
Sali-Cache Frame 46: cache=1500 time=0.220s [pruned=106, quant=0, kept=90] (before_opt=2692, after_opt=2586)
Sali-Cache Frame 47: cache=1500 time=0.169s [pruned=193, quant=0, kept=3] (before_opt=2692, after_opt=2499)
Sali-Cache Frame 48: cache=1500 time=0.197s [pruned=146, quant=0, kept=50] (before_opt=2692, after_opt=2546)
Sali-Cache Frame 49: cache=1500 time=0.228s [pruned=91, quant=0, kept=105] (before_opt=2692, after_opt=2601)
Sali-Cache Frame 50: cache=1500 time=0.237s [pruned=76, quant=0, kept=120] (before_opt=2692, after_opt=2616)
Sali-Cache Frame 51: cache=1500 time=0.181s [pruned=173, quant=0, kept=23] (before_opt=2692, after_opt=2519)
Sali-Cache Frame 52: cache=1500 time=0.179s [pruned=178, quant=0, kept=18] (before_opt=2692, after_opt=2514)
Sali-Cache Frame 53: cache=1500 time=0.244s [pruned=66, quant=0, kept=130] (before_opt=2692, after_opt=2626)
Sali-Cache Frame 54: cache=1500 time=0.233s [pruned=82, quant=0, kept=114] (before_opt=2692, after_opt=2610)
Sali-Cache Frame 55: cache=1500 time=0.222s [pruned=101, quant=0, kept=95] (before_opt=2692, after_opt=2591)
Sali-Cache Frame 56: cache=1500 time=0.184s [pruned=168, quant=0, kept=28] (before_opt=2692, after_opt=2524)
Sali-Cache Frame 57: cache=1500 time=0.237s [pruned=76, quant=0, kept=120] (before_opt=2692, after_opt=2616)
Sali-Cache Frame 58: cache=1500 time=0.231s [pruned=86, quant=0, kept=110] (before_opt=2692, after_opt=2606)
Sali-Cache Frame 59: cache=1500 time=0.171s [pruned=190, quant=0, kept=6] (before_opt=2692, after_opt=2502)
Sali-Cache Frame 60: cache=1500 time=0.182s [pruned=172, quant=0, kept=24] (before_opt=2692, after_opt=2520)
Sali-Cache Frame 61: cache=1500 time=0.240s [pruned=70, quant=0, kept=126] (before_opt=2692, after_opt=2622)
Sali-Cache Frame 62: cache=1500 time=0.165s [pruned=196, quant=0, kept=0] (before_opt=2692, after_opt=2496)
Sali-Cache Frame 63: cache=1500 time=0.229s [pruned=89, quant=0, kept=107] (before_opt=2692, after_opt=2603)
Sali-Cache Frame 64: cache=1500 time=0.169s [pruned=195, quant=0, kept=1] (before_opt=2692, after_opt=2497)
Sali-Cache Frame 65: cache=1500 time=0.168s [pruned=195, quant=0, kept=1] (before_opt=2692, after_opt=2497)
Sali-Cache Frame 66: cache=1500 time=0.170s [pruned=193, quant=0, kept=3] (before_opt=2692, after_opt=2499)
Sali-Cache Frame 67: cache=1500 time=0.175s [pruned=185, quant=0, kept=11] (before_opt=2692, after_opt=2507)
Sali-Cache Frame 68: cache=1500 time=0.197s [pruned=147, quant=0, kept=49] (before_opt=2692, after_opt=2545)
Sali-Cache Frame 69: cache=1500 time=0.230s [pruned=89, quant=0, kept=107] (before_opt=2692, after_opt=2603)
Sali-Cache Frame 70: cache=1500 time=0.172s [pruned=189, quant=0, kept=7] (before_opt=2692, after_opt=2503)
Sali-Cache Frame 71: cache=1500 time=0.165s [pruned=196, quant=0, kept=0] (before_opt=2692, after_opt=2496)
Sali-Cache Frame 72: cache=1500 time=0.169s [pruned=195, quant=0, kept=1] (before_opt=2692, after_opt=2497)
Sali-Cache Frame 73: cache=1500 time=0.221s [pruned=103, quant=0, kept=93] (before_opt=2692, after_opt=2589)
Sali-Cache Frame 74: cache=1500 time=0.236s [pruned=80, quant=0, kept=116] (before_opt=2692, after_opt=2612)
Sali-Cache Frame 75: cache=1500 time=0.238s [pruned=74, quant=0, kept=122] (before_opt=2692, after_opt=2618)
Sali-Cache Frame 76: cache=1500 time=0.228s [pruned=92, quant=0, kept=104] (before_opt=2692, after_opt=2600)
Sali-Cache Frame 77: cache=1500 time=0.234s [pruned=80, quant=0, kept=116] (before_opt=2692, after_opt=2612)
Sali-Cache Frame 78: cache=1500 time=0.208s [pruned=130, quant=0, kept=66] (before_opt=2692, after_opt=2562)
Sali-Cache Frame 79: cache=1500 time=0.177s [pruned=182, quant=0, kept=14] (before_opt=2692, after_opt=2510)
Sali-Cache Frame 80: cache=1500 time=0.224s [pruned=100, quant=0, kept=96] (before_opt=2692, after_opt=2592)
Sali-Cache Frame 81: cache=1500 time=0.233s [pruned=83, quant=0, kept=113] (before_opt=2692, after_opt=2609)
Sali-Cache Frame 82: cache=1500 time=0.229s [pruned=91, quant=0, kept=105] (before_opt=2692, after_opt=2601)
Sali-Cache Frame 83: cache=1500 time=0.202s [pruned=137, quant=0, kept=59] (before_opt=2692, after_opt=2555)
Sali-Cache Frame 84: cache=1500 time=0.237s [pruned=77, quant=0, kept=119] (before_opt=2692, after_opt=2615)
Sali-Cache Frame 85: cache=1500 time=0.186s [pruned=166, quant=0, kept=30] (before_opt=2692, after_opt=2526)
Sali-Cache Frame 86: cache=1500 time=0.246s [pruned=60, quant=0, kept=136] (before_opt=2692, after_opt=2632)
Sali-Cache Frame 87: cache=1500 time=0.212s [pruned=120, quant=0, kept=76] (before_opt=2692, after_opt=2572)
Sali-Cache Frame 88: cache=1500 time=0.184s [pruned=170, quant=0, kept=26] (before_opt=2692, after_opt=2522)
Sali-Cache Frame 89: cache=1500 time=0.172s [pruned=189, quant=0, kept=7] (before_opt=2692, after_opt=2503)
Sali-Cache Frame 90: cache=1500 time=0.172s [pruned=191, quant=0, kept=5] (before_opt=2692, after_opt=2501)
Sali-Cache Frame 91: cache=1500 time=0.170s [pruned=194, quant=0, kept=2] (before_opt=2692, after_opt=2498)
Sali-Cache Frame 92: cache=1500 time=0.165s [pruned=196, quant=0, kept=0] (before_opt=2692, after_opt=2496)
Sali-Cache Frame 93: cache=1500 time=0.165s [pruned=196, quant=0, kept=0] (before_opt=2692, after_opt=2496)
Sali-Cache Frame 94: cache=1500 time=0.233s [pruned=83, quant=0, kept=113] (before_opt=2692, after_opt=2609)
Sali-Cache Frame 95: cache=1500 time=0.172s [pruned=189, quant=0, kept=7] (before_opt=2692, after_opt=2503)
Sali-Cache Frame 96: cache=1500 time=0.234s [pruned=83, quant=0, kept=113] (before_opt=2692, after_opt=2609)
Sali-Cache Frame 97: cache=1500 time=0.168s [pruned=195, quant=0, kept=1] (before_opt=2692, after_opt=2497)
Sali-Cache Frame 98: cache=1500 time=0.228s [pruned=95, quant=0, kept=101] (before_opt=2692, after_opt=2597)
Sali-Cache Frame 99: cache=1500 time=0.165s [pruned=196, quant=0, kept=0] (before_opt=2692, after_opt=2496)
Sali-Cache experiment complete. Results saved to results/salicache.json
